// Malware.cpp : Ce fichier contient la fonction 'main'. L'exécution du programme commence et se termine à cet endroit.
//

#include <iostream>
#include <string>
#include <Windows.h>
using namespace std;

int main() {
    string userInput;
    string word = "oui";
    char* ppeb;
    int loop = 1;

    __asm {
        xor ebx, ebx
        xor ecx, ecx
        boucle :
            mov edx, 3
            add ebx, edx
            inc ecx
            cmp ecx, 16
            jl boucle
        mov eax, fs: [ebx]
        mov ppeb, eax
    }

    if ((int)ppeb[2] == 1) {
        cout << "Debugger c est tricher";
    }
    else {
        cout << "La seule fonction de ce programme est d afficher a l'ecran la chaine de caracteres saisie par l utilisateur\n";
        while (loop == 1) {
            cout << "Veuillez entrer une chaine de caracteres: \n";
            getline(cin, userInput);
            if (userInput == "UNTRUCACOMPLETER") {
                cout << "Vous avez trouve la phrase magique, bravo !!!";
                return 0;
            }
            else {
                cout << "Vous avez saisi: " << userInput << "\n";
                cin.ignore();
                cout << "Voulez-vous entrer une nouvelle chaine de caracteres ? Repondez par 'non' exactement pour sortir\n";
                getline(cin, word);
                cin.ignore();
                if (word == "non") { loop = 0; }
            }
        }
    }
    return 0;
}